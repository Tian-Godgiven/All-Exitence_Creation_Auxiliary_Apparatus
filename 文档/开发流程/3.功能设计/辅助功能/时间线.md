[toc]

# 时间线TimeLine

指定n个带有可被识别的时间值的对象，在时间线上按从小到大的顺序显示这些对象，可以横向移动时间轴或设定精确度，点击这些对象会显示具体详情

这些对象可以是：

1.事物

~~~
目标 : 分类/事物/时间属性T
显示 : 所有事物的名称按各自T属性的值排列在时间轴上
创建 : 如果所有事物均来源于同一个分类，则可以在时间轴上创建对应分类的新事物
~~~

2.关联属性

~~~
目标 : 分类/事物/关联属性/时间子属性T
显示 : 关联属性中的所有关联对象，按T属性的值排列在时间轴上
创建 : 可以在时间轴上创建关联属性的新关联对象
~~~

3.

~~~
目标: 章节 → 文本 / 无章节文本
目标属性 : 文本的更新时间 or 创建时间
显示 : 指定的所有文本对象，按T属性的值排列
~~~

## 对象

### 时间轴

顶部显示可编辑的标题，内部为一条向右延展的横线，上下两侧依次放置时间轴对象，可以被左右拖动。底部显示时间刻度。根据选择的时间单位改变刻度比例。

### 时间轴对象

显示对应目标的部分信息：

事物：分类名称/事物名称 + 指定属性名称，点击显示事物弹窗
文章：文章来源名称 + 文章名称，点击显示文章弹窗
事物属性：分类名称/事物名称/关联属性名称，点击显示事物弹窗

## 数据结构

保存在projects/data/timeLine.json中

~~~
TimeLine|TimeGroup[],//该项目中显示的时间线和时间线分组
~~~

### TimeLine 时间轴数据对象

根据目标类型有所不同

#### 事物类型

~~~
{
	targetType:"exitence",//时间线目标的类型
	key:{
		sourceKey:string, //这些事物所属的分类的key
		targetKey:{	//同一分类下的多个事物
			exitenceKey:string,//事物的key值
			statusKey:string//该事物应用的属性值的key
		}
	}[],
	timeRuleKey:string,//该时间线所使用的时间规则的key，参见自定义时间
	now:number|null = null,//该时间线当前所处的位置，默认为null表示从最早的一个对象开始
	unitStart?:string,//该时间线当前所显示的最大单位
	unitEnd?:string,//该时间线当前所显示的最小单位
}
~~~

#### 文章类型

~~~
{
	targetType:"article",//时间线目标的类型
	key:{
		sourceKey:string[], //这些文章的所有的父章节的key组成的数组
		targetKey:string[]//同一来源的多个文章的key组成的数组
	}[],
	timeStatus:"updateTime"|"createTime",//表示使用文章的更新时间或创建时间
	timeRuleKey:"date",//仅支持现实时间
	now:number|null=null,//该时间线当前所处的位置，默认为null表示从最早的一个对象开始
	unitStart?:string,//该时间线当前所显示的最大单位
	unitEnd?:string,//该时间线当前所显示的最小单位
}
~~~

#### 事物属性类型

~~~
{
	targetType:"status",//某个事物的属性，该属性通常包含时间子属性
	key:{
		sourceKey:string[], //该属性所在的事物的分类key+该事物key
		targetKey:string //该属性的key值
	},
	timeStatusKey:string,//该时间线所使用的时间属性的key
	timeRuleKey:string,//该时间线所使用的时间规则，参见自定义时间
	now:number|null=null,//该时间线当前所处的位置，默认为null表示从最早的一个对象开始
	unitStart?:string,//该时间线当前所显示的最大单位
	unitEnd?:string,//该时间线当前所显示的最小单位
}
~~~

## 业务流程

### 1.创建时间轴

选择目标类型

通过弹窗选择各自类型的对象
→事物类型：选择n个事物与对应的时间属性，返回分类，事物，时间属性
→文章类型：选择n个文章与这些文章使用的时间属性：更新时间or创建时间
→事物属性类型：选择1个事物与对应的关联属性，返回分类，事物与关联属性

根据返回的值列出所有选择的对象的信息，允许删除其中的对象
其中事物属性类型还要额外选择作为时间属性的关联子属性

选择时间轴中显示的时间单位

输入时间轴的起始时间

## 相关设置

分类设置：该分类/分组下的元素显示在时间线上时，使用的是哪一个date属性，默认为“不显示在时间上”，该设置会为分类/分组的操作面板上添加一个“显示在时间线上”的选项

   
